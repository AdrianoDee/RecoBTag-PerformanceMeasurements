process TopBTagEff  = {
  
  include "RecoBTag/PerformanceMeasurements/data/tag_consistency.cff"

module TtXsec = TtLJetsAnalyzer { 
              string outFile = "ttljets.root"
              string jetSource = "selectedLayer1TopJets"
              string electronSource = "selectedLayer1TopElectrons"
              string muonSource = "selectedLayer1TopMuons"
              string METSource = "selectedLayer1TopMETs"
              int32 nCaloJets_min = 4
              int32 nLepton_min = 1
              double jet_pt_min            = 25.0
              double jet_eta_max           = 2.4
              double muon_pt_min           = 20.0
              double muon_eta_max          = 2.4
              double muon_trackIso_max     = 3.0
              double muon_caloIso_max      = 6.0
              double electron_pt_min       = 20.0
              double electron_eta_max      = 2.4
              double electron_trackIso_max = 3.0
              double electron_caloIso_max  = 6.0
              double met_et_min            = 25.0
}

  # return trigger report (including filter efficiencies)
  untracked PSet options = { untracked bool wantSummary = true }

  replace csa07EventWeightProducer.talkToMe    = false
  replace csa07EventWeightProducer.overallLumi = 100.
  
  #replace MessageLogger.cerr.threshold = "INFO"
  #replace MessageLogger.cerr.threshold = "WARNING"
  replace MessageLogger.cerr.threshold = "ERROR"

  # apply a kinematic selection on the TopObjects
  replace selectedTopElectrons.cut = "pt > 20. & abs(eta) < 2.4 & getTrackIso < 3. & getCaloIso < 6."
  replace selectedTopMuons.cut = "pt > 20. & abs(eta) < 2.4 & getTrackIso < 3. & getCaloIso < 6."
  replace selectedTopJets.cut = "et > 25. & abs(eta) < 2.4"
  replace selectedTopMETs.cut = "et > 25."

  # filter events requiring a minimal number of final state TopObjects
  replace countTopLeptons.minNumber = 1
  replace countTopLeptons.maxNumber = 1
  replace minTopJets.minNumber = 4

  #service = Tracer { untracked string indention = "$$"}  
  
  # input
  untracked PSet maxEvents = {untracked int32 input = -1}
  source = PoolSource
  {
    untracked vstring fileNames =
    {
      #'file:/uscmst1b_scratch/lpc1/3DayLifetime/kukarzev/146E82D6-06E0-DC11-BF55-000423D98B6C.root'
      #'/store/CSA07/skim/2007/11/30/CSA07-CSA07Muon-Chowder-P1-PDMuon-Skims4/0011/06B8FADB-889F-DC11-9824-0017A4FF6E9C.root',
      #'/store/CSA07/skim/2007/12/14/CSA07-CSA07Electron-Chowder-B1-PDElectron-Skims8/0025/025360D0-97AE-DC11-9541-001A92971B32.root'
      #'/store/mc/2008/5/25/CSA07-Genwbb-alpgen-1211715927/0004/1055CB78-B12A-DD11-949E-001CC4BD552A.root'
      'file:/uscmst1b_scratch/lpc1/3DayLifetime/kukarzev/1055CB78-B12A-DD11-949E-001CC4BD552A.root'
    }
    #untracked uint32 skipEvents = 0
  }

  # path for CSA07 soup
  path p = {genParticles, csa07EventWeightProducer, csa07ProcessId, tqafHighLevelReco, allTopObjects, objectSelection, objectCountFiltering, myTopBTagAnalysis, TtXsec }

  # path for dedicated processes (weightproducer removed)
  #path p = {genParticles, csa07ProcessId, tqafHighLevelReco, allTopObjects, objectSelection, objectCountFiltering, myTopBTagAnalysis, TtXsec }

  
  endpath outpath = { out }

}
